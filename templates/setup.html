{% extends "base.html" %}

{% block title %}站點設定 - {{ site_title }}{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/setup.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/modal.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <header>
        <h1>站點設定</h1>
        <a href="/" class="find-sites-link">(返回主頁)</a>
    </header>

    <div class="card add-site-card">
        <div class="card-header">
            <h2>新增站點</h2>
            <a href="https://www.google.com/search?q=inurl:/api.php/provide/vod/" target="_blank"
                class="find-sites-link" title="在 Google 中搜尋 MacCMS 站點">
                🔍 尋找站點
            </a>
        </div>
        <div class="form-group">
            <label for="newSiteName">站點名稱 (可選)</label>
            <input type="text" id="newSiteName" placeholder="留空將自動生成">
        </div>
        <div class="form-group">
            <label for="newSiteUrl">站點URL</label>
            <input type="text" id="newSiteUrl" placeholder="https://example.com" required>
        </div>
        <button id="addSiteBtn" class="btn btn-success">新增站點</button>
    </div>

    <div class="site-list-manager">
        <h2>管理現有站點</h2>
        <div class="site-controls">
            <button id="checkAllSitesBtn" class="btn btn-info">檢查所有站點</button>
            <label class="checkbox-label">
                <input type="checkbox" id="includeDisabledCheckbox">
                <span>包含未啟用站點</span>
            </label>
            <div id="checkStatus" class="check-status"></div>
        </div>
        <ul id="siteList">
            <!-- 站點列表將由 JavaScript 動態生成 -->
        </ul>
    </div>

    <div class="card site-settings-card">
        <div class="card-header">
            <h2>網站外觀設定</h2>
        </div>
        <form id="siteSettingsForm" enctype="multipart/form-data">
            <div class="form-group">
                <label for="siteTitleInput">網站標題</label>
                <input type="text" id="siteTitleInput" name="site_title" placeholder="網站標題">
            </div>
            <div class="form-group">
                <label for="faviconInput">Favicon 圖示（SVG/PNG）</label>
                <input type="file" id="faviconInput" name="favicon" accept="image/svg+xml,image/png">
                <div id="faviconPreview" style="margin-top:8px;"></div>
            </div>
            <button type="submit" class="btn btn-primary">儲存外觀設定</button>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script type="module" src="{{ url_for('static', filename='js/modal.js') }}"></script>
<script type="module" src="{{ url_for('static', filename='js/setup.js') }}"></script>
{% endblock %}

<!-- body 結尾加上彈窗容器 -->
<div id="customModal"></div>